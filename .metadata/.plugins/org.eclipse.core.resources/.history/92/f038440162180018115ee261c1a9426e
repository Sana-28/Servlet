package com.bridgelabz.servletListener;

import java.sql.DriverManager;

import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

import com.mysql.jdbc.Connection;
import com.mysql.jdbc.PreparedStatement;

public class ContextListener implements ServletContextListener {

	Connection connection = null;
	PreparedStatement preparedStatement = null;

	@Override
	public void contextDestroyed(ServletContextEvent arg0) {
		try {
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("Driver Loaded and Registered..");

			connection = (Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/bidgelabz_db", "root",
					"root");
			System.out.println("Connection established with database..");

			preparedStatement = (PreparedStatement) connection.prepareStatement("insert into listener_emp values(?,?)");
			System.out.println("Platform Created..");
			
			preparedStatement.setString(1, "abc");
			preparedStatement.setString(2, "123");
			
			preparedStatement.executeUpdate();
			
		} catch (Exception e) {
			System.out.println(e);
		}
	}

	@Override
	public void contextInitialized(ServletContextEvent arg0) {
		System.out.println("Project not deplyed..");
	}

}
